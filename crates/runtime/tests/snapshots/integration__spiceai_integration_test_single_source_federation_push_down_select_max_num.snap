---
source: crates/runtime/tests/integration.rs
description: "Query: SELECT MAX(number) as max_num FROM blocks"
---
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                      |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | BytesProcessedNode                                                                                                                                                                                                                        |
|               |   Federated                                                                                                                                                                                                                               |
|               |  Projection: max(blocks.number) AS max_num                                                                                                                                                                                                |
|               |   Aggregate: groupBy=[[]], aggr=[[max(blocks.number)]]                                                                                                                                                                                    |
|               |     TableScan: blocks                                                                                                                                                                                                                     |
| physical_plan | BytesProcessedExec                                                                                                                                                                                                                        |
|               |   SchemaCastScanExec                                                                                                                                                                                                                      |
|               |     RepartitionExec: partitioning=RoundRobinBatch(3), input_partitions=1                                                                                                                                                                  |
|               |       VirtualExecutionPlan name=spiceai compute_context=url=https://flight.spiceai.io,username= sql=SELECT max(blocks.number) AS max_num FROM blocks rewritten_sql=SELECT max(eth.recent_blocks.number) AS max_num FROM eth.recent_blocks |
|               |                                                                                                                                                                                                                                           |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
