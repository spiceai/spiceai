---
source: crates/runtime/tests/integration.rs
description: "Query: SELECT number FROM blocks \n             UNION ALL\n             SELECT tx.block_number as number FROM tx\n             ORDER BY number DESC LIMIT 10"
---
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |   Federated                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |  Limit: skip=0, fetch=10                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |   Sort: blocks.number DESC NULLS FIRST                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |     Union                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |       Projection: blocks.number                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |         TableScan: blocks                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |       Projection: tx.block_number AS number                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |         TableScan: tx                                                                                                                                                                                                                                                                                                                                                                                                                          |
| physical_plan | BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |   SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |     RepartitionExec: partitioning=RoundRobinBatch(3), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                       |
|               |       VirtualExecutionPlan name=spice.ai compute_context=url=https://flight.spiceai.io,username= sql=SELECT blocks.number FROM blocks UNION ALL SELECT tx.block_number AS number FROM tx ORDER BY number DESC NULLS FIRST LIMIT 10 rewritten_sql=SELECT eth.recent_blocks.number FROM eth.recent_blocks UNION ALL SELECT eth.recent_transactions.block_number AS number FROM eth.recent_transactions ORDER BY number DESC NULLS FIRST LIMIT 10 |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
