---
source: crates/runtime/tests/integration.rs
description: "Query: SELECT number FROM blocks WHERE number = (SELECT MAX(number) FROM blocks)"
---
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                       |
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                         |
|               |   Federated                                                                                                                                                                                                                                                                                                                                                                |
|               |  Projection: blocks.number                                                                                                                                                                                                                                                                                                                                                 |
|               |   Filter: blocks.number = (<subquery>)                                                                                                                                                                                                                                                                                                                                     |
|               |     Subquery:                                                                                                                                                                                                                                                                                                                                                              |
|               |       Projection: max(blocks.number)                                                                                                                                                                                                                                                                                                                                       |
|               |         Aggregate: groupBy=[[]], aggr=[[max(blocks.number)]]                                                                                                                                                                                                                                                                                                               |
|               |           TableScan: blocks                                                                                                                                                                                                                                                                                                                                                |
|               |     TableScan: blocks                                                                                                                                                                                                                                                                                                                                                      |
| physical_plan | BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                         |
|               |   SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                       |
|               |     RepartitionExec: partitioning=RoundRobinBatch(3), input_partitions=1                                                                                                                                                                                                                                                                                                   |
|               |       VirtualExecutionPlan name=spiceai compute_context=url=https://flight.spiceai.io,username= sql=SELECT blocks.number FROM blocks WHERE (blocks.number = (SELECT max(blocks.number) FROM blocks)) rewritten_sql=SELECT eth.recent_blocks.number FROM eth.recent_blocks WHERE (eth.recent_blocks.number = (SELECT max(eth.recent_blocks.number) FROM eth.recent_blocks)) |
|               |                                                                                                                                                                                                                                                                                                                                                                            |
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
