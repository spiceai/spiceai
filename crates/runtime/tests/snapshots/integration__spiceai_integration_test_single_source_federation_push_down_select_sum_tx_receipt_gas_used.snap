---
source: crates/runtime/tests/integration.rs
description: "Query: SELECT SUM(tx.receipt_gas_used) AS total_gas_used, blocks.number FROM blocks JOIN tx ON blocks.number = tx.block_number GROUP BY blocks.number ORDER BY blocks.number DESC LIMIT 10"
---
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |   Federated                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |  Limit: skip=0, fetch=10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |   Sort: blocks.number DESC NULLS FIRST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |     Projection: sum(tx.receipt_gas_used) AS total_gas_used, blocks.number                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |       Aggregate: groupBy=[[blocks.number]], aggr=[[sum(tx.receipt_gas_used)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |         Inner Join:  Filter: blocks.number = tx.block_number                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |           TableScan: blocks                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |           TableScan: tx                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| physical_plan | BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |   SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |     RepartitionExec: partitioning=RoundRobinBatch(3), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |       VirtualExecutionPlan name=spiceai compute_context=url=https://flight.spiceai.io,username= sql=SELECT sum(tx.receipt_gas_used) AS total_gas_used, blocks.number FROM blocks JOIN tx ON (blocks.number = tx.block_number) GROUP BY blocks.number ORDER BY blocks.number DESC NULLS FIRST LIMIT 10 rewritten_sql=SELECT sum(eth.recent_transactions.receipt_gas_used) AS total_gas_used, eth.recent_blocks.number FROM eth.recent_blocks JOIN eth.recent_transactions ON (eth.recent_blocks.number = eth.recent_transactions.block_number) GROUP BY eth.recent_blocks.number ORDER BY eth.recent_blocks.number DESC NULLS FIRST LIMIT 10 |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
