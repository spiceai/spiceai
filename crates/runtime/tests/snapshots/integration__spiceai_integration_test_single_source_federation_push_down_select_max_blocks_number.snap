---
source: crates/runtime/tests/integration.rs
description: "Query: SELECT MAX(blocks_number) FROM (SELECT b1.number as blocks_number from blocks b1)"
---
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                  |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | BytesProcessedNode                                                                                                                                                                                                                                                                                    |
|               |   Federated                                                                                                                                                                                                                                                                                           |
|               |  Projection: max(blocks_number)                                                                                                                                                                                                                                                                       |
|               |   Aggregate: groupBy=[[]], aggr=[[max(blocks_number)]]                                                                                                                                                                                                                                                |
|               |     Projection: b1.number AS blocks_number                                                                                                                                                                                                                                                            |
|               |       SubqueryAlias: b1                                                                                                                                                                                                                                                                               |
|               |         TableScan: blocks                                                                                                                                                                                                                                                                             |
| physical_plan | BytesProcessedExec                                                                                                                                                                                                                                                                                    |
|               |   SchemaCastScanExec                                                                                                                                                                                                                                                                                  |
|               |     VirtualExecutionPlan name=spice.ai compute_context=url=https://flight.spiceai.io,username= sql=SELECT max(blocks_number) FROM (SELECT b1.number AS blocks_number FROM blocks AS b1) rewritten_sql=SELECT max(blocks_number) FROM (SELECT b1.number AS blocks_number FROM eth.recent_blocks AS b1) |
|               |                                                                                                                                                                                                                                                                                                       |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
