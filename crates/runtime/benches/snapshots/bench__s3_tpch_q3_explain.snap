---
source: crates/runtime/benches/bench.rs
description: "Query: select\n    l_orderkey,\n    sum(l_extendedprice * (1 - l_discount)) as revenue,\n    o_orderdate,\n    o_shippriority\nfrom\n    customer,\n    orders,\n    lineitem\nwhere\n      c_mktsegment = 'BUILDING'\n  and c_custkey = o_custkey\n  and l_orderkey = o_orderkey\n  and o_orderdate < date '1995-03-15'\n  and l_shipdate > date '1995-03-15'\ngroup by\n    l_orderkey,\n    o_orderdate,\n    o_shippriority\norder by\n    revenue desc,\n    o_orderdate;"
---
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: revenue DESC NULLS FIRST, orders.o_orderdate ASC NULLS LAST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |   Projection: lineitem.l_orderkey, sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount) AS revenue, orders.o_orderdate, orders.o_shippriority                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |     Aggregate: groupBy=[[lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority]], aggr=[[sum(lineitem.l_extendedprice * (Decimal128(Some(1),20,0) - lineitem.l_discount)) AS sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)]]                                                                                                                                                                                                                                                                                                                                    |
|               |       Projection: orders.o_orderdate, orders.o_shippriority, lineitem.l_orderkey, lineitem.l_extendedprice, lineitem.l_discount                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |         Inner Join: orders.o_orderkey = lineitem.l_orderkey                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |           Projection: orders.o_orderkey, orders.o_orderdate, orders.o_shippriority                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |             Inner Join: customer.c_custkey = orders.o_custkey                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |               Projection: customer.c_custkey                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                 BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                   Filter: customer.c_mktsegment = Utf8("BUILDING")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                     TableScan: customer projection=[c_custkey, c_mktsegment], partial_filters=[customer.c_mktsegment = Utf8("BUILDING")]                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                 Filter: orders.o_orderdate < Date32("1995-03-15")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                   TableScan: orders projection=[o_orderkey, o_custkey, o_orderdate, o_shippriority], partial_filters=[orders.o_orderdate < Date32("1995-03-15")]                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |           Projection: lineitem.l_orderkey, lineitem.l_extendedprice, lineitem.l_discount                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |             BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |               Filter: lineitem.l_shipdate > Date32("1995-03-15")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                 TableScan: lineitem projection=[l_orderkey, l_extendedprice, l_discount, l_shipdate], partial_filters=[lineitem.l_shipdate > Date32("1995-03-15")]                                                                                                                                                                                                                                                                                                                                                                                                                        |
| physical_plan | SortPreservingMergeExec: [revenue@1 DESC,o_orderdate@2 ASC NULLS LAST]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |   SortExec: expr=[revenue@1 DESC,o_orderdate@2 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |     ProjectionExec: expr=[l_orderkey@0 as l_orderkey, sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)@3 as revenue, o_orderdate@1 as o_orderdate, o_shippriority@2 as o_shippriority]                                                                                                                                                                                                                                                                                                                                                                                      |
|               |       AggregateExec: mode=FinalPartitioned, gby=[l_orderkey@0 as l_orderkey, o_orderdate@1 as o_orderdate, o_shippriority@2 as o_shippriority], aggr=[sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)]                                                                                                                                                                                                                                                                                                                                                                     |
|               |         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |           RepartitionExec: partitioning=Hash([l_orderkey@0, o_orderdate@1, o_shippriority@2], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |             AggregateExec: mode=Partial, gby=[l_orderkey@2 as l_orderkey, o_orderdate@0 as o_orderdate, o_shippriority@1 as o_shippriority], aggr=[sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)]                                                                                                                                                                                                                                                                                                                                                                        |
|               |               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(o_orderkey@0, l_orderkey@0)], projection=[o_orderdate@1, o_shippriority@2, l_orderkey@3, l_extendedprice@4, l_discount@5]                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                     RepartitionExec: partitioning=Hash([o_orderkey@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_custkey@0, o_custkey@1)], projection=[o_orderkey@1, o_orderdate@3, o_shippriority@4]                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                             RepartitionExec: partitioning=Hash([c_custkey@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                               ProjectionExec: expr=[c_custkey@0 as c_custkey]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                     FilterExec: c_mktsegment@1 = BUILDING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                       ParquetExec: file_groups={4 groups: [[tpch/customer/customer.parquet:0..3344327], [tpch/customer/customer.parquet:3344327..6688654], [tpch/customer/customer.parquet:6688654..10032981], [tpch/customer/customer.parquet:10032981..13377306]]}, projection=[c_custkey, c_mktsegment], predicate=c_mktsegment@6 = BUILDING, pruning_predicate=CASE WHEN c_mktsegment_null_count@2 = c_mktsegment_row_count@3 THEN false ELSE c_mktsegment_min@0 <= BUILDING AND BUILDING <= c_mktsegment_max@1 END, required_guarantees=[N] |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                             RepartitionExec: partitioning=Hash([o_custkey@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                   FilterExec: o_orderdate@2 < 1995-03-15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                     ParquetExec: file_groups={4 groups: [[tpch/orders/orders.parquet:0..13868792], [tpch/orders/orders.parquet:13868792..27737584], [tpch/orders/orders.parquet:27737584..41606376], [tpch/orders/orders.parquet:41606376..55475165]]}, projection=[o_orderkey, o_custkey, o_orderdate, o_shippriority], predicate=o_orderdate@4 < 1995-03-15, pruning_predicate=CASE WHEN o_orderdate_null_count@1 = o_orderdate_row_count@2 THEN false ELSE o_orderdate_min@0 < 1995-03-15 END, required_guarantees=[N]                                                  |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                     RepartitionExec: partitioning=Hash([l_orderkey@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                       ProjectionExec: expr=[l_orderkey@0 as l_orderkey, l_extendedprice@1 as l_extendedprice, l_discount@2 as l_discount]                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                             FilterExec: l_shipdate@3 > 1995-03-15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                               ParquetExec: file_groups={4 groups: [[tpch/lineitem/lineitem.parquet:0..51066574], [tpch/lineitem/lineitem.parquet:51066574..102133148], [tpch/lineitem/lineitem.parquet:102133148..153199722], [tpch/lineitem/lineitem.parquet:153199722..204266296]]}, projection=[l_orderkey, l_extendedprice, l_discount, l_shipdate], predicate=l_shipdate@10 > 1995-03-15, pruning_predicate=CASE WHEN l_shipdate_null_count@1 = l_shipdate_row_count@2 THEN false ELSE l_shipdate_max@0 > 1995-03-15 END, required_guarantees=[N]                                     |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
