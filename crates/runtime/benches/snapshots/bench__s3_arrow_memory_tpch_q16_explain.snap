---
source: crates/runtime/benches/bench.rs
description: "Query: select\n    p_brand,\n    p_type,\n    p_size,\n    count(distinct ps_suppkey) as supplier_cnt\nfrom\n    partsupp,\n    part\nwhere\n        p_partkey = ps_partkey\n  and p_brand <> 'Brand#45'\n  and p_type not like 'MEDIUM POLISHED%'\n  and p_size in (49, 14, 23, 45, 19, 3, 36, 9)\n  and ps_suppkey not in (\n    select\n        s_suppkey\n    from\n        supplier\n    where\n            s_comment like '%Customer%Complaints%'\n)\ngroup by\n    p_brand,\n    p_type,\n    p_size\norder by\n    supplier_cnt desc,\n    p_brand,\n    p_type,\n    p_size;"
---
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                          |
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: supplier_cnt DESC NULLS FIRST, part.p_brand ASC NULLS LAST, part.p_type ASC NULLS LAST, part.p_size ASC NULLS LAST                                                                                                                                                                                                                                                                      |
|               |   Projection: part.p_brand, part.p_type, part.p_size, count(alias1) AS supplier_cnt                                                                                                                                                                                                                                                                                                           |
|               |     Aggregate: groupBy=[[part.p_brand, part.p_type, part.p_size]], aggr=[[count(alias1)]]                                                                                                                                                                                                                                                                                                     |
|               |       Aggregate: groupBy=[[part.p_brand, part.p_type, part.p_size, partsupp.ps_suppkey AS alias1]], aggr=[[]]                                                                                                                                                                                                                                                                                 |
|               |         LeftAnti Join: partsupp.ps_suppkey = __correlated_sq_1.s_suppkey                                                                                                                                                                                                                                                                                                                      |
|               |           Projection: partsupp.ps_suppkey, part.p_brand, part.p_type, part.p_size                                                                                                                                                                                                                                                                                                             |
|               |             Inner Join: partsupp.ps_partkey = part.p_partkey                                                                                                                                                                                                                                                                                                                                  |
|               |               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                              |
|               |                 TableScan: partsupp projection=[ps_partkey, ps_suppkey]                                                                                                                                                                                                                                                                                                                       |
|               |               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                              |
|               |                 Filter: part.p_brand != Utf8("Brand#45") AND part.p_type NOT LIKE Utf8("MEDIUM POLISHED%") AND part.p_size IN ([Int32(49), Int32(14), Int32(23), Int32(45), Int32(19), Int32(3), Int32(36), Int32(9)])                                                                                                                                                                        |
|               |                   TableScan: part projection=[p_partkey, p_brand, p_type, p_size], partial_filters=[part.p_brand != Utf8("Brand#45"), part.p_type NOT LIKE Utf8("MEDIUM POLISHED%"), part.p_size IN ([Int32(49), Int32(14), Int32(23), Int32(45), Int32(19), Int32(3), Int32(36), Int32(9)])]                                                                                                 |
|               |           SubqueryAlias: __correlated_sq_1                                                                                                                                                                                                                                                                                                                                                    |
|               |             Projection: supplier.s_suppkey                                                                                                                                                                                                                                                                                                                                                    |
|               |               Filter: supplier.s_comment LIKE Utf8("%Customer%Complaints%")                                                                                                                                                                                                                                                                                                                   |
|               |                 TableScan: supplier projection=[s_suppkey, s_comment], partial_filters=[supplier.s_comment LIKE Utf8("%Customer%Complaints%")]                                                                                                                                                                                                                                                |
| physical_plan | SortPreservingMergeExec: [supplier_cnt@3 DESC,p_brand@0 ASC NULLS LAST,p_type@1 ASC NULLS LAST,p_size@2 ASC NULLS LAST]                                                                                                                                                                                                                                                                       |
|               |   SortExec: expr=[supplier_cnt@3 DESC,p_brand@0 ASC NULLS LAST,p_type@1 ASC NULLS LAST,p_size@2 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                                                                                                                                                                 |
|               |     ProjectionExec: expr=[p_brand@0 as p_brand, p_type@1 as p_type, p_size@2 as p_size, count(alias1)@3 as supplier_cnt]                                                                                                                                                                                                                                                                      |
|               |       AggregateExec: mode=FinalPartitioned, gby=[p_brand@0 as p_brand, p_type@1 as p_type, p_size@2 as p_size], aggr=[count(alias1)]                                                                                                                                                                                                                                                          |
|               |         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                           |
|               |           RepartitionExec: partitioning=Hash([p_brand@0, p_type@1, p_size@2], 4), input_partitions=4                                                                                                                                                                                                                                                                                          |
|               |             AggregateExec: mode=Partial, gby=[p_brand@0 as p_brand, p_type@1 as p_type, p_size@2 as p_size], aggr=[count(alias1)]                                                                                                                                                                                                                                                             |
|               |               AggregateExec: mode=FinalPartitioned, gby=[p_brand@0 as p_brand, p_type@1 as p_type, p_size@2 as p_size, alias1@3 as alias1], aggr=[]                                                                                                                                                                                                                                           |
|               |                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                   |
|               |                   RepartitionExec: partitioning=Hash([p_brand@0, p_type@1, p_size@2, alias1@3], 4), input_partitions=4                                                                                                                                                                                                                                                                        |
|               |                     AggregateExec: mode=Partial, gby=[p_brand@1 as p_brand, p_type@2 as p_type, p_size@3 as p_size, ps_suppkey@0 as alias1], aggr=[]                                                                                                                                                                                                                                          |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                             |
|               |                         HashJoinExec: mode=Partitioned, join_type=LeftAnti, on=[(ps_suppkey@0, s_suppkey@0)]                                                                                                                                                                                                                                                                                  |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                         |
|               |                             RepartitionExec: partitioning=Hash([ps_suppkey@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                         |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                     |
|               |                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ps_partkey@0, p_partkey@0)], projection=[ps_suppkey@1, p_brand@3, p_type@4, p_size@5]                                                                                                                                                                                                                   |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                 |
|               |                                     RepartitionExec: partitioning=Hash([ps_partkey@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                 |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                      |
|               |                                         SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                    |
|               |                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                |
|               |                                             MemoryExec: partitions=1, partition_sizes=[98]                                                                                                                                                                                                                                                                                                    |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                 |
|               |                                     RepartitionExec: partitioning=Hash([p_partkey@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                  |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                      |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                           |
|               |                                           FilterExec: p_brand@1 != Brand#45 AND p_type@2 NOT LIKE MEDIUM POLISHED% AND Use p_size@3 IN (SET) ([Literal { value: Int32(49) }, Literal { value: Int32(14) }, Literal { value: Int32(23) }, Literal { value: Int32(45) }, Literal { value: Int32(19) }, Literal { value: Int32(3) }, Literal { value: Int32(36) }, Literal { value: Int32(9) }]) |
|               |                                             SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                |
|               |                                               RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                            |
|               |                                                 MemoryExec: partitions=1, partition_sizes=[25]                                                                                                                                                                                                                                                                                                |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                         |
|               |                             RepartitionExec: partitioning=Hash([s_suppkey@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                          |
|               |                               ProjectionExec: expr=[s_suppkey@0 as s_suppkey]                                                                                                                                                                                                                                                                                                                 |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                   |
|               |                                   FilterExec: s_comment@1 LIKE %Customer%Complaints%                                                                                                                                                                                                                                                                                                          |
|               |                                     SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                        |
|               |                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                    |
|               |                                         MemoryExec: partitions=1, partition_sizes=[2]                                                                                                                                                                                                                                                                                                         |
|               |                                                                                                                                                                                                                                                                                                                                                                                               |
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
