---
source: crates/runtime/benches/bench.rs
description: "Query: select\n    sum(l_extendedprice* (1 - l_discount)) as revenue\nfrom\n    lineitem,\n    part\nwhere\n    (\n                p_partkey = l_partkey\n            and p_brand = 'Brand#12'\n            and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')\n            and l_quantity >= 1 and l_quantity <= 1 + 10\n            and p_size between 1 and 5\n            and l_shipmode in ('AIR', 'AIR REG')\n            and l_shipinstruct = 'DELIVER IN PERSON'\n        )\n   or\n    (\n                p_partkey = l_partkey\n            and p_brand = 'Brand#23'\n            and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')\n            and l_quantity >= 10 and l_quantity <= 10 + 10\n            and p_size between 1 and 10\n            and l_shipmode in ('AIR', 'AIR REG')\n            and l_shipinstruct = 'DELIVER IN PERSON'\n        )\n   or\n    (\n                p_partkey = l_partkey\n            and p_brand = 'Brand#34'\n            and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')\n            and l_quantity >= 20 and l_quantity <= 20 + 10\n            and p_size between 1 and 15\n            and l_shipmode in ('AIR', 'AIR REG')\n            and l_shipinstruct = 'DELIVER IN PERSON'\n        );"
---
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |   Federated                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |  Projection: sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount) AS revenue                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |   Aggregate: groupBy=[[]], aggr=[[sum(lineitem.l_extendedprice * (CAST(Int64(1) AS Decimal128(20, 0)) - lineitem.l_discount))]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |     Filter: part.p_partkey = lineitem.l_partkey AND part.p_brand = Utf8("Brand#12") AND part.p_container IN ([Utf8("SM CASE"), Utf8("SM BOX"), Utf8("SM PACK"), Utf8("SM PKG")]) AND CAST(lineitem.l_quantity AS Decimal128(22, 2)) >= CAST(Int64(1) AS Decimal128(22, 2)) AND CAST(lineitem.l_quantity AS Decimal128(22, 2)) <= CAST(Int64(1) + Int64(10) AS Decimal128(22, 2)) AND CAST(part.p_size AS Int64) BETWEEN Int64(1) AND Int64(5) AND lineitem.l_shipmode IN ([Utf8("AIR"), Utf8("AIR REG")]) AND lineitem.l_shipinstruct = Utf8("DELIVER IN PERSON") OR part.p_partkey = lineitem.l_partkey AND part.p_brand = Utf8("Brand#23") AND part.p_container IN ([Utf8("MED BAG"), Utf8("MED BOX"), Utf8("MED PKG"), Utf8("MED PACK")]) AND CAST(lineitem.l_quantity AS Decimal128(22, 2)) >= CAST(Int64(10) AS Decimal128(22, 2)) AND CAST(lineitem.l_quantity AS Decimal128(22, 2)) <= CAST(Int64(10) + Int64(10) AS Decimal128(22, 2)) AND CAST(part.p_size AS Int64) BETWEEN Int64(1) AND Int64(10) AND lineitem.l_shipmode IN ([Utf8("AIR"), Utf8("AIR REG")]) AND lineitem.l_shipinstruct = Utf8("DELIVER IN PERSON") OR part.p_partkey = lineitem.l_partkey AND part.p_brand = Utf8("Brand#34") AND part.p_container IN ([Utf8("LG CASE"), Utf8("LG BOX"), Utf8("LG PACK"), Utf8("LG PKG")]) AND CAST(lineitem.l_quantity AS Decimal128(22, 2)) >= CAST(Int64(20) AS Decimal128(22, 2)) AND CAST(lineitem.l_quantity AS Decimal128(22, 2)) <= CAST(Int64(20) + Int64(10) AS Decimal128(22, 2)) AND CAST(part.p_size AS Int64) BETWEEN Int64(1) AND Int64(15) AND lineitem.l_shipmode IN ([Utf8("AIR"), Utf8("AIR REG")]) AND lineitem.l_shipinstruct = Utf8("DELIVER IN PERSON")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |       CrossJoin:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |         TableScan: lineitem                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |         TableScan: part                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| physical_plan | BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |   SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |       VirtualExecutionPlan name=spiceai compute_context=url=https://flight.spiceai.io,username= sql=SELECT sum((lineitem.l_extendedprice * (CAST(1 AS DECIMAL(20,0)) - lineitem.l_discount))) AS revenue FROM lineitem JOIN part ON true WHERE ((((((((((part.p_partkey = lineitem.l_partkey) AND (part.p_brand = 'Brand#12')) AND part.p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')) AND (CAST(lineitem.l_quantity AS DECIMAL(22,2)) >= CAST(1 AS DECIMAL(22,2)))) AND (CAST(lineitem.l_quantity AS DECIMAL(22,2)) <= CAST((1 + 10) AS DECIMAL(22,2)))) AND (CAST(part.p_size AS BIGINT) BETWEEN 1 AND 5)) AND lineitem.l_shipmode IN ('AIR', 'AIR REG')) AND (lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR ((((((((part.p_partkey = lineitem.l_partkey) AND (part.p_brand = 'Brand#23')) AND part.p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')) AND (CAST(lineitem.l_quantity AS DECIMAL(22,2)) >= CAST(10 AS DECIMAL(22,2)))) AND (CAST(lineitem.l_quantity AS DECIMAL(22,2)) <= CAST((10 + 10) AS DECIMAL(22,2)))) AND (CAST(part.p_size AS BIGINT) BETWEEN 1 AND 10)) AND lineitem.l_shipmode IN ('AIR', 'AIR REG')) AND (lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR ((((((((part.p_partkey = lineitem.l_partkey) AND (part.p_brand = 'Brand#34')) AND part.p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')) AND (CAST(lineitem.l_quantity AS DECIMAL(22,2)) >= CAST(20 AS DECIMAL(22,2)))) AND (CAST(lineitem.l_quantity AS DECIMAL(22,2)) <= CAST((20 + 10) AS DECIMAL(22,2)))) AND (CAST(part.p_size AS BIGINT) BETWEEN 1 AND 15)) AND lineitem.l_shipmode IN ('AIR', 'AIR REG')) AND (lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) rewritten_sql=SELECT sum((tpch.lineitem.l_extendedprice * (CAST(1 AS DECIMAL(20,0)) - tpch.lineitem.l_discount))) AS revenue FROM tpch.lineitem JOIN tpch.part ON true WHERE ((((((((((tpch.part.p_partkey = tpch.lineitem.l_partkey) AND (tpch.part.p_brand = 'Brand#12')) AND tpch.part.p_container IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')) AND (CAST(tpch.lineitem.l_quantity AS DECIMAL(22,2)) >= CAST(1 AS DECIMAL(22,2)))) AND (CAST(tpch.lineitem.l_quantity AS DECIMAL(22,2)) <= CAST((1 + 10) AS DECIMAL(22,2)))) AND (CAST(tpch.part.p_size AS BIGINT) BETWEEN 1 AND 5)) AND tpch.lineitem.l_shipmode IN ('AIR', 'AIR REG')) AND (tpch.lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR ((((((((tpch.part.p_partkey = tpch.lineitem.l_partkey) AND (tpch.part.p_brand = 'Brand#23')) AND tpch.part.p_container IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')) AND (CAST(tpch.lineitem.l_quantity AS DECIMAL(22,2)) >= CAST(10 AS DECIMAL(22,2)))) AND (CAST(tpch.lineitem.l_quantity AS DECIMAL(22,2)) <= CAST((10 + 10) AS DECIMAL(22,2)))) AND (CAST(tpch.part.p_size AS BIGINT) BETWEEN 1 AND 10)) AND tpch.lineitem.l_shipmode IN ('AIR', 'AIR REG')) AND (tpch.lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR ((((((((tpch.part.p_partkey = tpch.lineitem.l_partkey) AND (tpch.part.p_brand = 'Brand#34')) AND tpch.part.p_container IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')) AND (CAST(tpch.lineitem.l_quantity AS DECIMAL(22,2)) >= CAST(20 AS DECIMAL(22,2)))) AND (CAST(tpch.lineitem.l_quantity AS DECIMAL(22,2)) <= CAST((20 + 10) AS DECIMAL(22,2)))) AND (CAST(tpch.part.p_size AS BIGINT) BETWEEN 1 AND 15)) AND tpch.lineitem.l_shipmode IN ('AIR', 'AIR REG')) AND (tpch.lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
