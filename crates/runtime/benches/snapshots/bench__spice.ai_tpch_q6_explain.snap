---
source: crates/runtime/benches/bench.rs
description: "Query: select\n    sum(l_extendedprice * l_discount) as revenue\nfrom\n    lineitem\nwhere\n        l_shipdate >= date '1994-01-01'\n  and l_shipdate < date '1995-01-01'\n  and l_discount between 0.06 - 0.01 and 0.06 + 0.01\n  and l_quantity < 24;"
---
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |   Federated                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |  Projection: sum(lineitem.l_extendedprice * lineitem.l_discount) AS revenue                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |   Aggregate: groupBy=[[]], aggr=[[sum(lineitem.l_extendedprice * lineitem.l_discount)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |     Filter: lineitem.l_shipdate >= CAST(CAST(Utf8("1994-01-01") AS Date32) AS Date64) AND lineitem.l_shipdate < CAST(CAST(Utf8("1995-01-01") AS Date32) AS Date64) AND CAST(lineitem.l_discount AS Decimal128(30, 15)) BETWEEN CAST(Float64(0.06) - Float64(0.01) AS Decimal128(30, 15)) AND CAST(Float64(0.06) + Float64(0.01) AS Decimal128(30, 15)) AND CAST(lineitem.l_quantity AS Decimal128(22, 2)) < CAST(Int64(24) AS Decimal128(22, 2))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |       TableScan: lineitem                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| physical_plan | BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |   SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |     VirtualExecutionPlan name=spice.ai compute_context=url=https://flight.spiceai.io,username= sql=SELECT sum((lineitem.l_extendedprice * lineitem.l_discount)) AS revenue FROM lineitem WHERE ((((lineitem.l_shipdate >= CAST(CAST('1994-01-01' AS DATE) AS DATETIME)) AND (lineitem.l_shipdate < CAST(CAST('1995-01-01' AS DATE) AS DATETIME))) AND (CAST(lineitem.l_discount AS DECIMAL(30,15)) BETWEEN CAST((CAST(0.06 AS DOUBLE) - CAST(0.01 AS DOUBLE)) AS DECIMAL(30,15)) AND CAST((CAST(0.06 AS DOUBLE) + CAST(0.01 AS DOUBLE)) AS DECIMAL(30,15)))) AND (CAST(lineitem.l_quantity AS DECIMAL(22,2)) < CAST(24 AS DECIMAL(22,2)))) rewritten_sql=SELECT sum((tpch.lineitem.l_extendedprice * tpch.lineitem.l_discount)) AS revenue FROM tpch.lineitem WHERE ((((tpch.lineitem.l_shipdate >= CAST(CAST('1994-01-01' AS DATE) AS TIMESTAMP)) AND (tpch.lineitem.l_shipdate < CAST(CAST('1995-01-01' AS DATE) AS TIMESTAMP))) AND (CAST(tpch.lineitem.l_discount AS DECIMAL(30,15)) BETWEEN CAST((CAST(0.06 AS DOUBLE) - CAST(0.01 AS DOUBLE)) AS DECIMAL(30,15)) AND CAST((CAST(0.06 AS DOUBLE) + CAST(0.01 AS DOUBLE)) AS DECIMAL(30,15)))) AND (CAST(tpch.lineitem.l_quantity AS DECIMAL(22,2)) < CAST(24 AS DECIMAL(22,2)))) |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
