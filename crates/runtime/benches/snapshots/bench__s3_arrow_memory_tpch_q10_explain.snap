---
source: crates/runtime/benches/bench.rs
description: "Query: select\n    c_custkey,\n    c_name,\n    sum(l_extendedprice * (1 - l_discount)) as revenue,\n    c_acctbal,\n    n_name,\n    c_address,\n    c_phone,\n    c_comment\nfrom\n    customer,\n    orders,\n    lineitem,\n    nation\nwhere\n        c_custkey = o_custkey\n  and l_orderkey = o_orderkey\n  and o_orderdate >= date '1993-10-01'\n  and o_orderdate < date '1994-01-01'\n  and l_returnflag = 'R'\n  and c_nationkey = n_nationkey\ngroup by\n    c_custkey,\n    c_name,\n    c_acctbal,\n    c_phone,\n    n_name,\n    c_address,\n    c_comment\norder by\n    revenue desc;"
---
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                     |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: revenue DESC NULLS FIRST                                                                                                                                                                                                                                                                                           |
|               |   Projection: customer.c_custkey, customer.c_name, sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount) AS revenue, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment                                                                                                |
|               |     Aggregate: groupBy=[[customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment]], aggr=[[sum(lineitem.l_extendedprice * (Decimal128(Some(1),20,0) - lineitem.l_discount)) AS sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)]] |
|               |       Projection: customer.c_custkey, customer.c_name, customer.c_address, customer.c_phone, customer.c_acctbal, customer.c_comment, lineitem.l_extendedprice, lineitem.l_discount, nation.n_name                                                                                                                        |
|               |         Inner Join: customer.c_nationkey = nation.n_nationkey                                                                                                                                                                                                                                                            |
|               |           Projection: customer.c_custkey, customer.c_name, customer.c_address, customer.c_nationkey, customer.c_phone, customer.c_acctbal, customer.c_comment, lineitem.l_extendedprice, lineitem.l_discount                                                                                                             |
|               |             Inner Join: orders.o_orderkey = lineitem.l_orderkey                                                                                                                                                                                                                                                          |
|               |               Projection: customer.c_custkey, customer.c_name, customer.c_address, customer.c_nationkey, customer.c_phone, customer.c_acctbal, customer.c_comment, orders.o_orderkey                                                                                                                                     |
|               |                 Inner Join: customer.c_custkey = orders.o_custkey                                                                                                                                                                                                                                                        |
|               |                   BytesProcessedNode                                                                                                                                                                                                                                                                                     |
|               |                     TableScan: customer projection=[c_custkey, c_name, c_address, c_nationkey, c_phone, c_acctbal, c_comment]                                                                                                                                                                                            |
|               |                   Projection: orders.o_orderkey, orders.o_custkey                                                                                                                                                                                                                                                        |
|               |                     BytesProcessedNode                                                                                                                                                                                                                                                                                   |
|               |                       Filter: orders.o_orderdate >= Date32("1993-10-01") AND orders.o_orderdate < Date32("1994-01-01")                                                                                                                                                                                                   |
|               |                         TableScan: orders projection=[o_orderkey, o_custkey, o_orderdate], partial_filters=[orders.o_orderdate >= Date32("1993-10-01"), orders.o_orderdate < Date32("1994-01-01")]                                                                                                                       |
|               |               Projection: lineitem.l_orderkey, lineitem.l_extendedprice, lineitem.l_discount                                                                                                                                                                                                                             |
|               |                 BytesProcessedNode                                                                                                                                                                                                                                                                                       |
|               |                   Filter: lineitem.l_returnflag = Utf8("R")                                                                                                                                                                                                                                                              |
|               |                     TableScan: lineitem projection=[l_orderkey, l_extendedprice, l_discount, l_returnflag], partial_filters=[lineitem.l_returnflag = Utf8("R")]                                                                                                                                                          |
|               |           BytesProcessedNode                                                                                                                                                                                                                                                                                             |
|               |             TableScan: nation projection=[n_nationkey, n_name]                                                                                                                                                                                                                                                           |
| physical_plan | SortPreservingMergeExec: [revenue@2 DESC]                                                                                                                                                                                                                                                                                |
|               |   SortExec: expr=[revenue@2 DESC], preserve_partitioning=[true]                                                                                                                                                                                                                                                          |
|               |     ProjectionExec: expr=[c_custkey@0 as c_custkey, c_name@1 as c_name, sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)@7 as revenue, c_acctbal@2 as c_acctbal, n_name@4 as n_name, c_address@5 as c_address, c_phone@3 as c_phone, c_comment@6 as c_comment]                                             |
|               |       AggregateExec: mode=FinalPartitioned, gby=[c_custkey@0 as c_custkey, c_name@1 as c_name, c_acctbal@2 as c_acctbal, c_phone@3 as c_phone, n_name@4 as n_name, c_address@5 as c_address, c_comment@6 as c_comment], aggr=[sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)]                            |
|               |         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                      |
|               |           RepartitionExec: partitioning=Hash([c_custkey@0, c_name@1, c_acctbal@2, c_phone@3, n_name@4, c_address@5, c_comment@6], 4), input_partitions=4                                                                                                                                                                 |
|               |             AggregateExec: mode=Partial, gby=[c_custkey@0 as c_custkey, c_name@1 as c_name, c_acctbal@4 as c_acctbal, c_phone@3 as c_phone, n_name@8 as n_name, c_address@2 as c_address, c_comment@5 as c_comment], aggr=[sum(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)]                               |
|               |               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                |
|               |                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_nationkey@3, n_nationkey@0)], projection=[c_custkey@0, c_name@1, c_address@2, c_phone@4, c_acctbal@5, c_comment@6, l_extendedprice@7, l_discount@8, n_name@10]                                                                                   |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                            |
|               |                     RepartitionExec: partitioning=Hash([c_nationkey@3], 4), input_partitions=4                                                                                                                                                                                                                           |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                        |
|               |                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(o_orderkey@7, l_orderkey@0)], projection=[c_custkey@0, c_name@1, c_address@2, c_nationkey@3, c_phone@4, c_acctbal@5, c_comment@6, l_extendedprice@9, l_discount@10]                                                                        |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                    |
|               |                             RepartitionExec: partitioning=Hash([o_orderkey@7], 4), input_partitions=4                                                                                                                                                                                                                    |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                |
|               |                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_custkey@0, o_custkey@1)], projection=[c_custkey@0, c_name@1, c_address@2, c_nationkey@3, c_phone@4, c_acctbal@5, c_comment@6, o_orderkey@7]                                                                                      |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                            |
|               |                                     RepartitionExec: partitioning=Hash([c_custkey@0], 4), input_partitions=4                                                                                                                                                                                                             |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                                                 |
|               |                                         SchemaCastScanExec                                                                                                                                                                                                                                                               |
|               |                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                           |
|               |                                             MemoryExec: partitions=1, partition_sizes=[19]                                                                                                                                                                                                                               |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                            |
|               |                                     RepartitionExec: partitioning=Hash([o_custkey@1], 4), input_partitions=4                                                                                                                                                                                                             |
|               |                                       ProjectionExec: expr=[o_orderkey@0 as o_orderkey, o_custkey@1 as o_custkey]                                                                                                                                                                                                        |
|               |                                         BytesProcessedExec                                                                                                                                                                                                                                                               |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                    |
|               |                                             FilterExec: o_orderdate@2 >= 1993-10-01 AND o_orderdate@2 < 1994-01-01                                                                                                                                                                                                       |
|               |                                               RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                       |
|               |                                                 SchemaCastScanExec                                                                                                                                                                                                                                                       |
|               |                                                   MemoryExec: partitions=1, partition_sizes=[0]                                                                                                                                                                                                                          |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                    |
|               |                             RepartitionExec: partitioning=Hash([l_orderkey@0], 4), input_partitions=4                                                                                                                                                                                                                    |
|               |                               ProjectionExec: expr=[l_orderkey@0 as l_orderkey, l_extendedprice@1 as l_extendedprice, l_discount@2 as l_discount]                                                                                                                                                                        |
|               |                                 BytesProcessedExec                                                                                                                                                                                                                                                                       |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                            |
|               |                                     FilterExec: l_returnflag@3 = R                                                                                                                                                                                                                                                       |
|               |                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                               |
|               |                                         SchemaCastScanExec                                                                                                                                                                                                                                                               |
|               |                                           MemoryExec: partitions=1, partition_sizes=[0]                                                                                                                                                                                                                                  |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                            |
|               |                     RepartitionExec: partitioning=Hash([n_nationkey@0], 4), input_partitions=4                                                                                                                                                                                                                           |
|               |                       BytesProcessedExec                                                                                                                                                                                                                                                                                 |
|               |                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                             |
|               |                           SchemaCastScanExec                                                                                                                                                                                                                                                                             |
|               |                             MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                                                                                                |
|               |                                                                                                                                                                                                                                                                                                                          |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
